#-------------------------------------------
#Preparatory work.
#-------------------------------------------
library(nortest)
library(car)
#-------------------------------------------
#Input data
#-------------------------------------------
x <- c(79.997, 	79.999,	80.019,	80.001,	79.984,	80.005,	79.965,	79.972,
       79.996,	79.988,	79.990,	79.986,	80.005,	80.005,	79.974,	80.024,
       79.983,	79.964,	80.007,	80.010,	79.978,	80.029,	80.005,	80.030,
       80.006,	80.006,	79.990,	79.964,	79.965,	80.022,	80.007,	80.011,
       80.031,	80.021,	80.035,	79.993,	80.024,	80.032,	80.006,	79.990,
       79.973,	80.002,	80.006,	80.006,	79.991,	79.974,	79.980,	79.986,
       80.015,	79.994,	79.985,	79.975,	80.040,	79.996,	80.008,	80.014,
       80.002,	80.017,	80.037,	80.023,	80.052,	80.002,	80.003	
)
#-------------------------------------------
#Andersonâ€“Darling test
#-------------------------------------------
ad.test(x)
#-------------------------------------------
#Plot Histogram
#-------------------------------------------
hist(x,breaks=seq(79.8,80.2,0.01),prob=TRUE)
abline(v=79.9, col="blue",lwd=2)
abline(v=80.1, col="blue",lwd=2)
abline(v=80.0, col="red",lwd=2)
#-------------------------------------------
#Q-Q plot
#-------------------------------------------
qqPlot(x, col.lines="red", id=FALSE)  
#-------------------------------------------
#Calculate Cpmk hat
#-------------------------------------------
m <- mean(x)
s <- var(x)
USL <- 80.1
LSL <- 79.9
d <- (USL-LSL)/2
M <- (USL+LSL)/2
t <- 80
Cpmk <- (d-abs(m-M))/(3*(s+(m-t)^2)^(1/2))